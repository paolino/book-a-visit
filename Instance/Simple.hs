{-# language DataKinds #-}
{-# language TypeFamilies #-}
{-# language GADTs #-}
{-# language MultiParamTypeClasses #-}
{-# language DeriveDataTypeable #-}
{-# language StandaloneDeriving #-}
{-# language FlexibleInstances #-}
{-# language FlexibleContexts #-}
{-# language UndecidableInstances #-}
{-# language Rank2Types #-}
{-# language TemplateHaskell #-}
{-# language ScopedTypeVariables #-}
{-# language ConstraintKinds #-}
{-# language DeriveAnyClass #-}
{-# language OverloadedStrings #-}
{-# language RecursiveDo #-}
{-# language QuasiQuotes #-}
{-# language TypeInType #-}
{-# language ViewPatterns #-}
{-# language OverloadedLists #-}

module Instance.Simple where

import Data.Dependent.Map (DMap,DSum((:=>)), singleton)
import qualified Data.Dependent.Map as DMap
import Data.GADT.Compare (GCompare)
import Data.GADT.Compare.TH
import Lib -- (MS,ES,DS, Reason, domMorph, EitherG(LeftG,RightG), rightG,leftG, Cable,sselect)
import Reflex.Dom hiding (Delete, Insert, Link)
import Data.Bifunctor
import Control.Lens hiding (dropping)
import Data.Data.Lens
import Data.Data
import Data.Typeable
import Control.Lens.TH
import System.Random
import qualified Data.Map as M
import Status
import World
import Data.Text (Text,pack,unpack)
import Data.String.Here
import Data.String
import Control.Monad
import Data.Maybe
import Data.Monoid
import Control.Monad.Trans
import Data.Either
import UI.Acceptance
import UI.Proposal

data S

---------- example -------------------------------
type instance Bargain S = String
data instance Part Taker S = Client {fromClient :: String} deriving (Show,Eq)
data instance Part Giver S = Business {fromBusiness :: String} deriving (Show,Eq)
type instance Chat S = String
type instance Zone u S = (Float,Float,Maybe Float)
data instance Place u S = Place (Float,Float) deriving (Read, Show)
type instance Slot S = (Float,Float)
-- type instance Time S = (Float)
type instance Failure S = String
type instance Feedback S = String

instance SlotMatch S where
  data Time S = T Float
  matchLow (t0 , t1) (T t) = t >= t0
  matchHigh (t0 , t1) (T t) = t >= t1



deriving instance Show (World S)



